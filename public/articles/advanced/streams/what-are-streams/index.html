
<!-- required content -->

<link rel="stylesheet" href="/css/nodedocs.css" type="text/css" media="screen" title="no title" charset="utf-8">
<link rel="stylesheet" href="/css/highlight/github.css" type="text/css" media="screen" title="no title" charset="utf-8">


<header>
  <div class="link"><a href="http://github.com/nodejitsu/docs">Edit this page on GitHub</a></div>
  <div class="title">docs.nodejitsu.com</div>
</header>


<script type="text/javascript">var _sf_startpt=(new Date()).getTime()</script>

<div id="mask"></div>

<!-- end required content -->

<div id="toc"><ul><li><a href="/articles/advanced">advanced</a><ul><li><a href="/articles/advanced/buffers">buffers</a><ul><li><a href="/articles/advanced/buffers/how-to-use-buffers">how to use buffers</a></li></ul></li><li><a href="/articles/advanced/streams">streams</a><ul><li><a href="/articles/advanced/streams/how-to-use-fs-create-read-stream">how to use fs create read stream</a></li><li><a href="/articles/advanced/streams/how-to-use-fs-create-write-stream">how to use fs create write stream</a></li><li><a href="/articles/advanced/streams/how-to-use-stream-pipe">how to use stream pipe</a></li><li><a href="/articles/advanced/streams/what-are-streams">what are streams</a></li></ul></li></ul></li><li><a href="/articles/child-processes">child processes</a><ul><li><a href="/articles/child-processes/how-to-spawn-a-child-process">how to spawn a child process</a></li></ul></li><li><a href="/articles/command-line">command line</a><ul><li><a href="/articles/command-line/how-to-get-colors-on-the-command-line">how to get colors on the command line</a></li><li><a href="/articles/command-line/how-to-parse-command-line-arguments">how to parse command line arguments</a></li><li><a href="/articles/command-line/how-to-prompt-for-command-line-input">how to prompt for command line input</a></li></ul></li><li><a href="/articles/cryptography">cryptography</a><ul><li><a href="/articles/cryptography/how-to-use-crypto-module">how to use crypto module</a></li><li><a href="/articles/cryptography/how-to-use-the-tls-module">how to use the tls module</a></li></ul></li><li><a href="/articles/errors">errors</a><ul><li><a href="/articles/errors/what-are-the-error-conventions">what are the error conventions</a></li><li><a href="/articles/errors/what-is-the-error-object">what is the error object</a></li><li><a href="/articles/errors/what-is-try-catch">what is try catch</a></li></ul></li><li><a href="/articles/file-system">file system</a><ul><li><a href="/articles/file-system/how-to-read-files-in-nodejs">how to read files in nodejs</a></li><li><a href="/articles/file-system/how-to-search-files-and-directories-in-nodejs">how to search files and directories in nodejs</a></li><li><a href="/articles/file-system/how-to-store-local-config-data">how to store local config data</a></li><li><a href="/articles/file-system/how-to-use-the-path-module">how to use the path module</a></li><li><a href="/articles/file-system/how-to-write-files-in-nodejs">how to write files in nodejs</a></li></ul></li><li><a href="/articles/getting-started">getting started</a><ul><li><a href="/articles/getting-started/control-flow">control flow</a><ul><li><a href="/articles/getting-started/control-flow/how-to-write-asynchronous-code">how to write asynchronous code</a></li><li><a href="/articles/getting-started/control-flow/what-are-callbacks">what are callbacks</a></li><li><a href="/articles/getting-started/control-flow/what-are-event-emitters">what are event emitters</a></li></ul></li><li><a href="/articles/getting-started/globals-in-node-js">globals in node js</a></li><li><a href="/articles/getting-started/how-to-debug-nodejs-applications">how to debug nodejs applications</a></li><li><a href="/articles/getting-started/how-to-use-util-inspect">how to use util inspect</a></li><li><a href="/articles/getting-started/npm">npm</a><ul><li><a href="/articles/getting-started/npm/how-to-access-module-package-info">how to access module package info</a></li><li><a href="/articles/getting-started/npm/what-is-npm">what is npm</a></li><li><a href="/articles/getting-started/npm/what-is-the-file-package-json">what is the file package json</a></li></ul></li><li><a href="/articles/getting-started/the-console-module">the console module</a></li><li><a href="/articles/getting-started/the-process-module">the process module</a></li><li><a href="/articles/getting-started/what-is-require">what is require</a></li></ul></li><li><a href="/articles/HTTP">HTTP</a><ul><li><a href="/articles/HTTP/clients">clients</a><ul><li><a href="/articles/HTTP/clients/how-to-access-query-string-parameters">how to access query string parameters</a></li><li><a href="/articles/HTTP/clients/how-to-create-a-HTTP-request">how to create a HTTP request</a></li></ul></li><li><a href="/articles/HTTP/servers">servers</a><ul><li><a href="/articles/HTTP/servers/how-to-create-a-HTTP-server">how to create a HTTP server</a></li><li><a href="/articles/HTTP/servers/how-to-create-a-HTTPS-server">how to create a HTTPS server</a></li><li><a href="/articles/HTTP/servers/how-to-read-POST-data">how to read POST data</a></li><li><a href="/articles/HTTP/servers/how-to-serve-static-files">how to serve static files</a></li></ul></li></ul></li><li><a href="/articles/javascript-conventions">javascript conventions</a><ul><li><a href="/articles/javascript-conventions/how-to-create-default-parameters-for-functions">how to create default parameters for functions</a></li><li><a href="/articles/javascript-conventions/what-are-the-built-in-timer-functions">what are the built in timer functions</a></li><li><a href="/articles/javascript-conventions/what-are-truthy-and-falsy-values">what are truthy and falsy values</a></li><li><a href="/articles/javascript-conventions/what-is-json">what is json</a></li><li><a href="/articles/javascript-conventions/what-is-the-arguments-object">what is the arguments object</a></li></ul></li><li><a href="/articles/REPL">REPL</a><ul><li><a href="/articles/REPL/how-to-create-a-custom-repl">how to create a custom repl</a></li><li><a href="/articles/REPL/how-to-use-nodejs-repl">how to use nodejs repl</a></li></ul></li></ul></div>

<!-- generated content -->
<div id="article">
  <div id="metadata">
    <h1 class="title">What are streams?</h1>
    <div class="date">Fri Aug 26 2011 03:08:50 GMT-0700 (PST)</div>
    <div class="author">nico</div>
    <div class="link">./articles/advanced/streams/what-are-streams</div>
    

    <!--
      <div class="tags"></div>
      <div class="difficulty"></div>
    -->
  <div class="breadcrumb">.</div><div class="breadcrumb">articles</div><div class="breadcrumb">advanced</div><div class="breadcrumb">streams</div><div class="breadcrumb">what-are-streams</div></div>
  <div id="content"><p>Streams are another basic construct in node.js that encourages asynchronous coding. Streams allow you to process the data as it is generated or retrieved. Streams can be readable, writeable, or both. </p>

<p>In other words, Streams use events to deal with data as it happens, rather than only with a callback at the end.  Readable streams emit the event <code>data</code> for each chunk of data that comes in, and an <code><span class="identifier"><span class="keyword">end</span></span></code> event, which is emitted when there is no more data. Writeable streams can be written to with the <code><span class="identifier"><span class="keymethods">write</span></span>()</code> function, and closed with the <code><span class="identifier"><span class="keyword">end</span></span>()</code> function.  All types of streams emit <code>error</code> events when errors arise.</p>

<p>As a quick example, we can write a simple version of <code>cp</code> (the unix utility that copies files). We could do that by reading the whole file with standard filesystem calls and then writing it out to a file. Unfortunately, that requires that the whole file be read in before it can be written. In the case of 1-2 giga files, you could run into out of memory operations. The biggest advantage that streams give you over their non-stream versions are that you can start process the info before you have all the information. In this case, writing out the file doesn't get sped up, but if we were streaming over the internet or doing cpu processing on it then there could be measurable performance improvements.</p>

<p>Run this script with arguments like <code>node cp.js src.txt dest.txt</code>. This would mean, in the code below, that <code>process.argv[2]</code> is <code>src.txt</code> and <code>process.argv[3]</code> is <code>desc.txt</code>. </p>

<pre><code><span class="keyword">var</span> fs = require(<span class="string">'fs'</span>);
console.log(process.argv[<span class="number">2</span>], <span class="string">'-&gt;'</span>, process.argv[<span class="number">3</span>]);

<span class="keyword">var</span> readStream = fs.createReadStream(process.argv[<span class="number">2</span>]);
<span class="keyword">var</span> writeStream = fs.createWriteStream(process.argv[<span class="number">3</span>]);

readStream.on(<span class="string">'data'</span>, <span class="function"><span class="keyword">function</span> <span class="params">(chunk)</span> {</span>
  writeStream.write(chunk);
});

readStream.on(<span class="string">'end'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
  writeStream.end();
});

<span class="comment">//Some basic error handling</span>
readStream.on(<span class="string">'error'</span>, <span class="function"><span class="keyword">function</span> <span class="params">(err)</span> {</span>
  console.log(&quot;ERROR&quot;, err);
});

writeStream.on(<span class="string">'error'</span>, <span class="function"><span class="keyword">function</span> <span class="params">(err)</span> {</span>
  console.log(&quot;ERROR&quot;, err);
});</code></pre>

<p>This sets up a readable stream from the source file and a writable stream to the destination file. Then whenever the readable stream gets data, it gets written to the writeable stream. Then finally it closes the writable stream when the readable stream is finished. NOTE: it would have been better to use <a href="/how-to-use-stream-pipe">pipe</a> like <code><span class="constant">readStream</span>.<span class="identifier"><span class="keymethods">pipe</span></span>(<span class="constant">writeStream</span>);</code>, however, to show how streams work, we have done things the long way.</p></div>
</div>

<!-- end generated content -->

<script type="text/javascript" charset="utf-8" src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>
<script type="text/javascript" charset="utf-8" src="/js/index.js"></script>

<script type="text/javascript">
var _sf_async_config={uid:11119,domain:"docs.nodejitsu.com"};
(function(){
  function loadChartbeat() {
    window._sf_endpt=(new Date()).getTime();
    var e = document.createElement('script');
    e.setAttribute('language', 'javascript');
    e.setAttribute('type', 'text/javascript');
    e.setAttribute('src',
       (("https:" == document.location.protocol) ? "https://a248.e.akamai.net/chartbeat.download.akamai.com/102508/" : "http://static.chartbeat.com/") +
       "js/chartbeat.js");
    document.body.appendChild(e);
  }
  var oldonload = window.onload;
  window.onload = (typeof window.onload != 'function') ?
     loadChartbeat : function() { oldonload(); loadChartbeat(); };
})();

</script>